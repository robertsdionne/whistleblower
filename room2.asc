// room script file

int last_mouse_move_time = 0;
int update_interval = 1; // seconds
int last_mouse_x = 0, last_mouse_y = 0;


function MouseMoved() {
  return mouse.x != last_mouse_x || mouse.y != last_mouse_y;
}


function Tooltip(String text) {
  cTooltip.x = mouse.x + 64;
  cTooltip.y = mouse.y + 48;
  cTooltip.SayBackground(text);
}


function repeatedly_execute() {
  DateTime *now = DateTime.Now;
  if (MouseMoved()) {
    last_mouse_move_time = now.RawTime;
  }
  last_mouse_x = mouse.x;
  last_mouse_y = mouse.y;
  if (last_mouse_move_time + update_interval < now.RawTime) {
    Object *hover = Object.GetAtScreenXY(mouse.x, mouse.y);
    if (MailIcon == hover) {
      String mailTooltip = "Mail";
      if (115 == MailIcon.Graphic) {
        mailTooltip = "New Mail";
      }
      Tooltip(mailTooltip);
    } else if (DocumentsIcon == hover) {
      Tooltip("Document Archive");
    } else if (WorkIcon == hover) {
      Tooltip("Traveler Profiles");
    } else if (ChatIcon == hover) {
      Tooltip("Chat");
    }
  }
}


function MailIcon_AnyClick() {
  OpenMail();
  MailIcon.Graphic = 16; // read mail icon
}


function DocumentsIcon_AnyClick() {
  OpenDocuments();
}


function WorkIcon_AnyClick() {
  OpenWork();
}


function ChatIcon_AnyClick() {
  OpenChat();
}
