// new module script

int news_views[];
int news_views_length = 7;

String news_updates[];
int news_updates_length = 24;
int news_updates_index = 0;


int last_update_time = 0;
int update_interval = 45; // seconds


function game_start() {
  news_views = new int[news_views_length];
  news_views[0] = NEWSVIEW1;
  news_views[1] = NEWSVIEW2;
  news_views[2] = NEWSVIEW3;
  news_views[3] = NEWSVIEW4;
  news_views[4] = NEWSVIEW5;
  news_views[5] = NEWSVIEW6;
  news_views[6] = NEWSVIEW7;
  
  news_updates = new String[news_updates_length];
  news_updates[0] = "Crowds form lines at embassies for evacuation wave permits.";
  news_updates[1] = "Embassy lines become violent as rumors of evacuation permit quotas grow.";
  news_updates[2] = "Riots turn deadly as protests erupt over corruption scandal...";
  news_updates[3] = "Citizens of <location> accuse government officials of arrogance as protests gain momentum in at least five cities.";
  news_updates[4] = "Police blocked hundreds of protesters from taking to the streets and gathering in central Square...";
  news_updates[5] = "Agitated protesters on Friday evening threw rocks and firecrackers at police, shouting in reference to a widening corruption scandal gripping Prime Minister Tuts' government.";
  news_updates[6] = "Assassination attempts on officials...rumours despite denial from national security";
  news_updates[7] = "Confederate secret service conspire to poison the cities' water supply";
  news_updates[8] = "Explosives expert plotting to blow up Capitol building arrested";
  news_updates[9] = "Independent press condemns censorship and threats from military factions";
  news_updates[10] = "Passengers on Wave 50 gone missing";
  news_updates[11] = "Man in investigation for illegal boarding of Wave 49";
  news_updates[12] = "Ark silent on any further embarkment headed to Boulder";
  news_updates[13] = "Asteroid risks increase monthly";
  news_updates[14] = "Rumours of a group of extremists sneaking into restricted facilities destroying transport pods lead to possible delays in departure...";
  news_updates[15] = "Prophecies by astrologists, mythologists confirm impending cataclysmic events...";
  news_updates[16] = "Scientists dismiss rumours and attempt to calm the public";
  news_updates[17] = "Families continue to plead with authorities...";
  news_updates[18] = "Congressman renounces extraction to remain with his sick mother who is 72 years old...";
  news_updates[19] = "Pleas for justice grow as injured protesters are hospitalized with fatal injuries inflicted by corrupt police";
  news_updates[20] = "Rumours of a secondary transport constructed by private investors...";
  news_updates[21] = "Rainforests poisoning itself, killing millions of biotic life.";
  news_updates[22] = "Forest Fires";
  news_updates[23] = "Omens - Birds falling from the sky";

  DateTime *now = DateTime.Now;
  last_update_time = now.RawTime;
}


function repeatedly_execute() {
  DateTime *now = DateTime.Now;
  if (2 == player.Room && !Mail.Visible && news_updates_index < news_updates_length) {
    if (last_update_time + update_interval < now.RawTime) {
      Speech.DisplayPostTimeMs = 5000;
      Aldebaran.Play();
      cNewsFeed.SpeechView = news_views[news_updates_index % news_views_length];
      cNewsFeed.Say(news_updates[news_updates_index]);
      news_updates_index += 1;
      last_update_time = now.RawTime;
    }
  }
}
